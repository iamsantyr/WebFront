<div class="registro-container">
  <div class="registro-card">
    <!-- Header con icono decorativo -->
    <div class="card-header">
      <div class="icon-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="12" y1="20" x2="12" y2="10"></line>
          <line x1="18" y1="20" x2="18" y2="4"></line>
          <line x1="6" y1="20" x2="6" y2="16"></line>
          <circle cx="12" cy="10" r="2"></circle>
          <circle cx="18" cy="4" r="2"></circle>
          <circle cx="6" cy="16" r="2"></circle>
        </svg>
      </div>
      <h2>Registro de Proceso</h2>
      <p class="subtitle">Crea un nuevo proceso en el sistema</p>
    </div>

    <form (ngSubmit)="onRegistrarProceso()" #procesoForm="ngForm">
      <!-- Nombre del proceso -->
      <div class="input-group">
        <label for="name">Nombre del Proceso</label>
        <input
          type="text"
          id="name"
          name="name"
          [(ngModel)]="procesoDto.name"
          required
          placeholder="Ej: Onboarding de clientes"
        />
      </div>

      <!-- Descripción -->
      <div class="input-group">
        <label for="description">Descripción</label>
        <textarea
          id="description"
          name="description"
          [(ngModel)]="procesoDto.description"
          required
          rows="3"
          placeholder="Breve descripción del proceso"
        ></textarea>
      </div>

      <!-- Categoría -->
      <div class="input-group">
        <label for="category">Categoría</label>
        <input
          type="text"
          id="category"
          name="category"
          [(ngModel)]="procesoDto.category"
          placeholder="Ej: Comercial / Operaciones"
        />
      </div>

      <!-- Estado -->
      <div class="input-group">
        <label for="status">Estado</label>
        <select
          id="status"
          name="status"
          [(ngModel)]="procesoDto.status"
          required
        >
          <option [ngValue]="null" disabled>Selecciona un estado</option>
          <option *ngFor="let s of statuses" [ngValue]="s">{{ s }}</option>
        </select>
      </div>

      <!-- ID de organización -->
      <div class="input-group">
        <label for="organizationId">ID de Organización</label>
        <input
          type="number"
          id="organizationId"
          name="organizationId"
          [(ngModel)]="procesoDto.organizationId"
          required
          min="1"
          placeholder="Ej: 900123456"
        />
      </div>

      <!-- ===== SECCIÓN DE RELACIONES ===== -->
      <div class="relations-section">
        <h3 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="16 18 22 12 16 6"></polyline>
            <polyline points="8 6 2 12 8 18"></polyline>
          </svg>
          Relaciones del Proceso
        </h3>

        <!-- Actividades -->
        <div class="input-group">
          <label for="activityIds">Actividades (IDs)</label>
          <select
            multiple
            id="activityIds"
            name="activityIds"
            [(ngModel)]="procesoDto.activityIds"
            size="5"
          >
            <option *ngFor="let a of activitiesCatalogo" [ngValue]="a.id">
              {{ a.id }} — {{ a.name }}
            </option>
          </select>
          <small class="hint">Mantén presionado Ctrl/Cmd para seleccionar múltiples</small>
        </div>

        <!-- Arcos -->
        <div class="input-group">
          <label for="archIds">Arcos (IDs)</label>
          <select
            multiple
            id="archIds"
            name="archIds"
            [(ngModel)]="procesoDto.archIds"
            size="5"
          >
            <option *ngFor="let ar of archsCatalogo" [ngValue]="ar.id">
              {{ ar.id }} — ({{ ar.actividadI }} ➜ {{ ar.actividadD }})
            </option>
          </select>
          <small class="hint">Mantén presionado Ctrl/Cmd para seleccionar múltiples</small>
        </div>

        <!-- Gateways -->
        <div class="input-group">
          <label for="gatewayIds">Gateways (IDs)</label>
          <select
            multiple
            id="gatewayIds"
            name="gatewayIds"
            [(ngModel)]="procesoDto.gatewayIds"
            size="5"
          >
            <option *ngFor="let g of gatewaysCatalogo" [ngValue]="g.id">
              {{ g.id }} — {{ g.type }}
            </option>
          </select>
          <small class="hint">Mantén presionado Ctrl/Cmd para seleccionar múltiples</small>
        </div>
      </div>

      <!-- Botón de envío -->
      <button type="submit" [disabled]="procesoForm.invalid">
        <span class="button-content">Guardar Proceso</span>
      </button>

      <!-- Footer -->
      <div class="card-footer">
        <span>¿Volver?</span>
        <a routerLink="/procesos">Lista de procesos</a>
      </div>
    </form>
  </div>
</div>